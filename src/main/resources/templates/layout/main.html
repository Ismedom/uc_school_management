<!doctype html>
<html
    xmlns:th="http://www.thymeleaf.org"
    xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
    th:fragment="layout(content, title)"
>
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title th:replace="${title}">School Management System</title>
        <!-- Tailwind CSS -->
        <script src="https://cdn.tailwindcss.com"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            primary: '#3b82f6',
                            secondary: '#64748b',
                        },
                    },
                },
            };
        </script>
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"
        />
        <style>
            /* Custom scrollbar for sidebar */
            .no-scrollbar::-webkit-scrollbar {
                display: none;
            }

            .no-scrollbar {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
        </style>
    </head>

    <body class="bg-gray-50 text-slate-800 font-sans antialiased flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <aside class="w-64 bg-white border-r border-gray-200 hidden md:flex flex-col">
            <div class="h-16 flex items-center px-6 border-b border-gray-200">
                <i class="fas fa-graduation-cap text-primary text-2xl mr-3"></i>
                <span class="text-xl font-bold tracking-tight text-slate-900">SchoolHub</span>
            </div>

            <nav class="flex-1 overflow-y-auto py-4">
                <ul class="space-y-1 px-3">
                    <li>
                        <a
                            href="/dashboard"
                            th:class="${currentUri == '/dashboard' ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-home w-6 text-center mr-2"></i>
                            Dashboard
                        </a>
                    </li>
                    <!-- Admin/Super Admin and Teacher Menu Items -->
                    <li
                        sec:authorize="hasAnyRole('SUPER_ADMIN', 'ADMIN', 'TEACHER')"
                        class="pt-4 pb-2 px-3 text-xs font-semibold text-slate-400 uppercase tracking-wider"
                    >
                        Management
                    </li>
                    <li sec:authorize="hasAnyRole('SUPER_ADMIN', 'ADMIN')">
                        <a
                            href="/students"
                            th:class="${currentUri != null && #strings.startsWith(currentUri, '/students') ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-users w-6 text-center mr-2"></i>
                            Students
                        </a>
                    </li>
                    <li sec:authorize="hasAnyRole('SUPER_ADMIN', 'ADMIN')">
                        <a
                            href="/teachers"
                            th:class="${currentUri != null && #strings.startsWith(currentUri, '/teachers') ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-chalkboard-teacher w-6 text-center mr-2"></i>
                            Teachers
                        </a>
                    </li>
                    <li sec:authorize="hasAnyRole('SUPER_ADMIN', 'ADMIN')">
                        <a
                            href="/classes"
                            th:class="${currentUri != null && (#strings.startsWith(currentUri, '/classes') || #strings.startsWith(currentUri, '/subjects')) ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-book w-6 text-center mr-2"></i>
                            Classes & Subjects
                        </a>
                    </li>
                    <li
                        sec:authorize="hasAnyRole('SUPER_ADMIN', 'ADMIN', 'TEACHER')"
                        class="pt-4 pb-2 px-3 text-xs font-semibold text-slate-400 uppercase tracking-wider"
                    >
                        Academic
                    </li>
                    <li sec:authorize="hasAnyRole('SUPER_ADMIN', 'ADMIN', 'TEACHER')">
                        <a
                            href="/attendance"
                            th:class="${currentUri == '/attendance' ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-calendar-plus w-6 text-center mr-2"></i>
                            Mark Attendance
                        </a>
                    </li>
                    <li sec:authorize="hasAnyRole('SUPER_ADMIN', 'ADMIN', 'TEACHER')">
                        <a
                            href="/attendance/list"
                            th:class="${currentUri == '/attendance/list' ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-list w-6 text-center mr-2"></i>
                            Attendance Records
                        </a>
                    </li>
                    <li sec:authorize="hasAnyRole('SUPER_ADMIN', 'ADMIN', 'TEACHER')">
                        <a
                            href="/exams"
                            th:class="${currentUri != null && #strings.startsWith(currentUri, '/exams') ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-file-alt w-6 text-center mr-2"></i>
                            Exams & Grades
                        </a>
                    </li>

                    <!-- Student Menu Items -->
                    <li
                        sec:authorize="hasRole('STUDENT')"
                        class="pt-4 pb-2 px-3 text-xs font-semibold text-slate-400 uppercase tracking-wider"
                    >
                        My Academic
                    </li>
                    <li sec:authorize="hasRole('STUDENT')">
                        <a
                            href="/student/profile"
                            th:class="${currentUri == '/student/profile' ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-user w-6 text-center mr-2"></i>
                            My Profile
                        </a>
                    </li>
                    <li sec:authorize="hasRole('STUDENT')">
                        <a
                            href="/student/grades"
                            th:class="${currentUri == '/student/grades' ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-chart-line w-6 text-center mr-2"></i>
                            My Grades
                        </a>
                    </li>
                    <li sec:authorize="hasRole('STUDENT')">
                        <a
                            href="/student/attendance"
                            th:class="${currentUri == '/student/attendance' ? 'flex items-center px-3 py-2.5 rounded-lg bg-primary/10 text-primary font-medium' : 'flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors'}"
                            class="flex items-center px-3 py-2.5 rounded-lg text-slate-600 hover:bg-slate-50 hover:text-slate-900 transition-colors"
                        >
                            <i class="fas fa-calendar-check w-6 text-center mr-2"></i>
                            My Attendance
                        </a>
                    </li>
                </ul>
            </nav>

            <div class="p-4 border-t border-gray-200">
                <div class="flex items-center gap-3">
                    <div
                        class="w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500"
                    >
                        <i class="fas fa-user"></i>
                    </div>
                    <div class="flex-1 min-w-0">
                        <p
                            class="text-sm font-medium text-slate-900 truncate"
                            sec:authorize="isAuthenticated()"
                            sec:authentication="name"
                        >
                            Guest
                        </p>
                        <p class="text-xs text-slate-500 truncate">Administrator</p>
                    </div>
                    <form th:action="@{/logout}" method="post">
                        <button
                            type="submit"
                            class="text-slate-400 hover:text-red-500 transition-colors"
                        >
                            <i class="fas fa-sign-out-alt"></i>
                        </button>
                    </form>
                </div>
            </div>
        </aside>

        <!-- Mobile Header -->
        <div
            class="md:hidden fixed top-0 w-full bg-white border-b border-gray-200 z-50 px-4 h-16 flex items-center justify-between"
        >
            <div class="flex items-center">
                <i class="fas fa-graduation-cap text-primary text-2xl mr-2"></i>
                <span class="text-lg font-bold">SchoolHub</span>
            </div>
            <button class="text-slate-500">
                <i class="fas fa-bars text-xl"></i>
            </button>
        </div>

        <!-- Main Content -->
        <main class="flex-1 flex flex-col h-screen md:overflow-hidden pt-16 md:pt-0">
            <div class="flex-1 overflow-y-auto bg-gray-50 p-4 md:p-8">
                <div th:replace="${content}">
                    <!-- Content placeholder -->
                </div>
            </div>
        </main>
    </body>
</html>
